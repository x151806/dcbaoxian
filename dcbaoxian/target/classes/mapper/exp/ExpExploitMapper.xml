<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dc.exp.dao.ExpExploitDao">
  
   <insert id="insertobject" parameterType="com.dc.exp.entity.ExpExploit">
       insert into exploit_develop 
       (developId,developNumber,createdTime,system,port,menu,executor,appointedTime,status,effect,remarkContent,remarkSatrap)
       values
       (#{developId},#{developNumber},getdate(),#{system},#{port},#{menu},#{executor},#{appointedTime}
       ,#{status},#{effect},#{remarkContent},#{remarkSatrap})
    </insert>
   
   <insert id="insertProgress" parameterType="com.dc.exp.entity.ExpProgress">
       insert into exploit_progress 
       (progressId,disId,progress,createdTime,createdUser)
       values
       (#{progressId},#{disId},#{progress},getdate(),#{createdUser})
    </insert>
   
   <!-- 基于id执行删除 -->
   <delete id="deleteObjects">
      
      delete from exploit_develop 
      where developId =#{developId}
   
   </delete>
   <!-- 基于id执行删除 -->
   <delete id="deleteProgress">
      
      delete from exploit_progress 
      where disId =#{disId}
   
   </delete>
   <update id="updateFinishTime" 
       parameterType="com.dc.exp.entity.ExpExploit">
        update exploit_develop 
        set finishTime=null 
        where developId=#{developId}
    </update>
   <update id="updateExploit" 
       parameterType="com.dc.exp.entity.ExpExploit">
         update exploit_develop
         <set>
             
             <if test="developNumber!=null and developNumber!=''">
                developNumber=#{developNumber},
             </if>
             <if test="system!=null and system!=''">
                system=#{system},
             </if>
             <if test="port!=null and port!=''">
                port=#{port},
             </if>
             <if test="menu!=null and menu!=''">
                menu=#{menu},
             </if>
             <if test="effect!=null and effect!=''">
                effect=#{effect},
             </if>
             <if test="executor!=null and executor!=''">
                executor=#{executor},
             </if>

             <if test="appointedTime!=null and appointedTime!=''">
                appointedTime=#{appointedTime},
             </if>
             <if test="status!=null and status!=''">
                status=#{status},
             </if>
             <if test="remarkContent!=null and remarkContent!=''">
                remarkContent=#{remarkContent},
             </if>
             <if test="remarkSatrap!=null and remarkSatrap!=''">
                remarkSatrap=#{remarkSatrap},
             </if>
             <if test="finishTime!=null and finishTime!=''">
                finishTime=#{finishTime},
             </if>
          </set>
        where developId=#{developId}
    </update>
   
   
  
   
   
  
   <select id="findByNumber"
           resultType="com.dc.exp.entity.ExpExploit">
       
	       select * 
         from exploit_develop 
         where developNumber=#{developNumber}
   </select>
   <select id="getRowCount"
           resultType="int">
       
	        select count(*) 
	        from exploit_develop 
	        where 1=1 
	        <if test="username!=null and username!=''">
	         and username=#{username} 
	        </if>
	        <if test="status!=null and status!=''">
	         and status=#{status} 
	        </if>
   </select>
   
   <select id="findPageObjects"
           resultType="com.dc.exp.entity.ExpExploit">
           
         select top ${pageSize} * 
         from exploit_develop 
         where developId not in (select top ${startIndex} developId from exploit_develop 
         where 1=1 
	        <if test="username!=null and username!=''">
	         and username=#{username} 
	        </if>
	        <if test="status!=null and status!=''">
	         and status=#{status} 
	        </if>
         order by status asc,createdTime desc) 
	        <if test="username!=null and username!=''">
	         and username=#{username} 
	        </if>
	        <if test="status!=null and status!=''">
	         and status=#{status} 
	        </if>
         order by status asc,createdTime desc
         
   </select>
   
   
   
   
   <select id="findProgressById"
		resultType="com.dc.exp.entity.ExpProgress">
		select * 
		from exploit_progress 
		where disId=#{disId} 
		order by createdTime asc
	</select>
   
   
   
   <select id="findObjectById"
		resultType="com.dc.exp.entity.ExpExploit">
		select * 
		from exploit_develop 
		where developId=#{developId}
	</select>
</mapper>
